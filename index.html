<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <script src="https://game-ultimate.com/assets/wdgt.js"></script>

    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"
    />
    <title>Games</title>
  </head>
  <body>
    <div id="root">
      <button onclick="trigger('fortuneWheel')">
        Trigger =&gt; Fortune Wheel
      </button>
    </div>

    <script>
      const config = {
        uid: uid,
        apiToken: "secret-api-token",
        organizationId: "8ddeb71e-c6e6-4345-8735-b84f8b833be1",
        // organizationId: '305e31bf-57fb-4a95-9fa7-cf877335e8a6',
      };

      async function trigger(game) {
        await testFireTrigger(game);
      }

      async function testFireTrigger(game) {
        return fetch(
          "https://gamixter-backend.ngrok.dev/organization/trigger/test-fire",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: config.apiToken,
            },
            body: JSON.stringify({
              userId: config.uid,
              organizationId: config.organizationId,
              game: game,
            }),
          }
        )
          .then((response) => response.json())
          .then((response) => {
            return response;
          })
          .catch((error) => {
            console.error("Failed to fire trigger:", error);
            return null;
          });
      }
    </script>
    <script>
      const data = {
        widgetKey: "c7b29122-ff18-4110-92c7-72230bf36c16",
        uid: "100-500-Ivan",
        wsUrl: "wss://236bc78256f9.ngrok.app/connection/websocket",
        tokenUrl: "https://gamixter-backend.ngrok.dev/centrifugo/generate-jwt",
      };

      const widget = new GamixterWidget(
        data.widgetKey,
        data.uid,
        data.wsUrl,
        data.tokenUrl
      );
      widget.init();

      widget.ready().then(() => {
        console.log("Widget is ready to receive games.");
      });
    </script>
  </body>
</html>
